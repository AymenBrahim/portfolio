@reference "../App.css";

@layer components {
  @media (pointer: fine) and (min-width: 641px) {
    header {
      @apply py-5 px-12 fixed top-0 inset-0 z-10 h-[var(--header-height)] bg-header-shade/80 backdrop-blur-sm text-dark-shade shadow-sm;
      & nav {
        @apply h-full;
      }

      & > nav > ul {
        @apply flex h-full items-center;

        & > li {
          @apply w-fit;

          & a,
          & span {
            @apply block h-full py-2 px-4 font-secondary text-[1rem]/[2rem] font-extrabold text-center align-middle;
          }

          &.dropdown > ul {
            @apply left-0 top-[calc(100%+16px)] translate-y-[1.25rem] translate-x-0;
          }
        }

        & .dropdown {
          @apply relative;
          & > ul {
            @apply absolute left-full top-0
            bg-header-shade/80 backdrop-blur-sm rounded-b-md  shadow-lg 
          z-1
          before:w-full before:absolute /* before:bg-blue */ before:h-[var(--before-height)] 
          before:-top-[var(--before-height)] before:left-0 
          scale-50 opacity-0 -translate-x-full invisible;
          }

          & > ul > li {
            & {
              @apply text-dark-shade;
            }

            &:hover {
              @apply bg-dark-accent/75 rounded-md;
            }
          }

          &:hover > ul {
            @apply visible scale-100 opacity-100 translate-y-0 translate-x-0  transition-all duration-100;
          }

          & .dropdown:nth-child(n + 2) > ul {
            @apply rounded-md;
          }
        }
      }
    }
  }

  @media (pointer: coarse) or (max-width: 640px) {
    body:has(header > nav > ul.expanded)::after {
      @apply backdrop-blur-sm bg-[#000a] ease-out pointer-events-auto duration-300;
    }

    body::after {
      @apply content-[""] fixed inset-0 w-screen h-screen bg-[#0000] z-2 transition-all ease-in duration-200 pointer-events-none;
    }

    header {
      @apply fixed flex top-0 right-0  pt-8 pr-8 pl-2 z-10  bg-header-shade/0 transition-all duration-300  h-16.5 overflow-hidden;
      overscroll-behavior: none;
      transition: all 300ms ease-in, height 0ms ease-out 300ms;

      &::before {
        @apply content-[""]  absolute top-6 right-6 h-8.5 w-10 bg-header-shade/80 backdrop-blur-sm opacity-100 rounded-sm;
      }

      /* &::before {
        @apply content-[""] fixed inset-0 w-screen h-screen bg-[#0005] z-2;
      } */

      &:has(> nav > ul.expanded) {
        @apply pl-6 pb-12 bg-header-shade/80 text-dark-shade overflow-scroll backdrop-blur-md ml-auto rounded-l-md h-screen;
        transition: height 0ms ease-out;

        box-shadow: -4px 0 10px rgba(0, 0, 0, 0.3);
        &::before {
          @apply opacity-0;
        }

        & > .hamburger {
          & > div:first-child {
            transform-origin: 0 0;
            transform: rotate(45deg);
          }
          & > div:nth-child(2) {
            @apply scale-0;
          }
          & > div:nth-child(3) {
            transform-origin: 0 100%;
            transform: rotate(-45deg);
          }
        }
      }

      & > .hamburger {
        @apply relative h-4.5 w-6 border-none;
        &::after {
          @apply content-[""] absolute h-8.5 w-10 -inset-2;
        }

        & > div {
          @apply absolute bg-dark-shade w-6 h-0.5 duration-150 transition-all;
        }
        & > div:first-child {
          @apply top-0;
        }
        & > div:nth-child(2) {
          @apply top-0 bottom-0 my-auto;
        }
        & > div:nth-child(3) {
          @apply bottom-0;
        }
      }

      & > nav ul li {
        @apply h-fit whitespace-nowrap;

        & a {
          @apply block py-2 block underline;
        }

        & span {
          @apply inline;
        }

        & a,
        & span {
          @apply h-full py-2 px-4 font-secondary text-[1rem]/[2rem] font-extrabold;
        }
      }

      & > nav > ul {
        @apply flex flex-col items-start mt-8 w-0;
        transition: width 300ms ease-in;
        &.expanded {
          @apply flex flex-col items-start mt-8 w-[13.625rem] overflow-scroll;
          transition: width 300ms ease-out;
        }

        & > li {
          & > span.dropdown-label {
            @apply pr-6 relative py-3 block;
          }

          & > span.dropdown-label::after {
            @apply content-[""] absolute right-1 top-0 bottom-0 my-auto size-4;
            background-image: url("/chevron-down.svg");
            transition: all 100ms;
          }

          &.expanded > span.dropdown-label::after {
            transform: rotate(180deg);
          }

          & > a {
            @apply py-3;
          }

          &.dropdown {
            @apply ml-0;
            & > ul {
              @apply ml-0;
            }
          }
        }

        & .dropdown {
          @apply ml-3;
          & > ul {
            @apply ml-3 hidden;

            & > li {
              & > span.dropdown-label {
                @apply pr-6 relative py-3 block;
              }

              & > span.dropdown-label::after {
                @apply content-[""] absolute right-1 top-0 bottom-0 my-auto size-4;
                background-image: url("/chevron-down.svg");
                transition: all 100ms;
              }

              &.expanded > span.dropdown-label::after {
                transform: rotate(180deg);
              }
            }
          }

          &.expanded {
            & > ul {
              @apply flex flex-col;
            }
          }
        }
      }
    }
  }
}
